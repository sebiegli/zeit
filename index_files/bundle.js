!function(){"use strict";var e=e=>new Promise(((t,r)=>{const n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",e.url),e.integrity&&n.setAttribute("integrity",e.integrity),e.async&&n.setAttribute("async",e.async.toString()),e.defer&&n.setAttribute("defer",e.defer.toString()),e.crossOrigin&&n.setAttribute("crossorigin",e.crossOrigin),n.onload=t,n.onerror=r,document.head.appendChild(n)}));var t=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();var r=e=>{try{return JSON.parse(e),!0}catch(e){return!1}};var n=e=>window.webkit&&window.webkit.messageHandlers&&e.ios in window.webkit.messageHandlers&&"function"==typeof window.webkit.messageHandlers[e.ios].postMessage?"ios":e.android in window?"android":"";var a=e=>"object"===t(e)?{...e}:"array"===t(e)?[...e]:e;const i=(e,r)=>{if("object"!==t(e))return e;const n={},a=Object.keys(e),s=Object.keys(r);for(let o=0,c=a.length;o<c;o+=1){const c=a[o],u=e[c],l=s.indexOf(c)>-1?r[c]:c;if("object"===t(u))n[l]=i({...u},r);else if("array"===t(u)){n[l]=[...u];for(let e=0,t=u.length;e<t;e+=1)n[l][e]=i(u[e],r)}else n[l]=u}return n};var s=i,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u=function(e,t){return e===t||e!=e&&t!=t},l="object"==typeof o&&o&&o.Object===Object&&o,d=l,h="object"==typeof self&&self&&self.Object===Object&&self,f=d||h||Function("return this")(),m=f.Symbol,E=m,p=Object.prototype,v=p.hasOwnProperty,_=p.toString,g=E?E.toStringTag:void 0;var O=function(e){var t=v.call(e,g),r=e[g];try{e[g]=void 0;var n=!0}catch(e){}var a=_.call(e);return n&&(t?e[g]=r:delete e[g]),a},y=Object.prototype.toString;var S=O,b=function(e){return y.call(e)},I=m?m.toStringTag:void 0;var T=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":I&&I in Object(e)?S(e):b(e)};var A=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},N=T,R=A;var D=function(e){if(!R(e))return!1;var t=N(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var w=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},C=D,L=w;var M=function(e){return null!=e&&L(e.length)&&!C(e)},j=/^(?:0|[1-9]\d*)$/;var P=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&j.test(e))&&e>-1&&e%1==0&&e<t};var U=function(e){return null!=e&&"object"==typeof e};let V="~";function F(){}Object.create&&(F.prototype=Object.create(null),(new F).__proto__||(V=!1));class G{constructor(e,t,r=!1){this.handler=e,this.context=t,this.once=r}}function x(e,t,r,n,a){if("function"!=typeof r)throw new TypeError("The handler must be a function.");if("symbol"==typeof t&&e._prefix)throw new TypeError("The event name cannot be a symbol when events should be prefixed. Use string literals instead.");const i=new G(r,n||e,a),s=e._prefix?`${e._prefix}${t}`:t;return e._listeners[s]||(e._listeners[s]=[],e._listenerCount+=1),e._listeners[s].push(i),e}function q(e,t){const r=e._prefix?`${e._prefix}${t}`:t;0==--e._listenerCount?e._listeners=new F:delete e._listeners[r]}function k(e,t,...r){e.parent&&e.parent instanceof $&&e.parent.emit(t,...r)}class ${get eventNames(){let e=[];return 0===this._listenerCount||(e=e.concat(Object.keys(this._listeners).map((e=>this._prefix?e.slice(1):e))),Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(this._listeners)))),e}get parent(){return this._parent}set parent(e){this._parent=e}constructor(){this._prefix=V,this._listeners=new F,this._listenerCount=0,this._parent=void 0}has(e){if("symbol"==typeof e)return Object.getOwnPropertySymbols(this._listeners).includes(e);const t=this._prefix?`${this._prefix}${e}`:e;return Object.keys(this._listeners).includes(t)}on(e,t,r){return x(this,e,t,r)}once(e,t,r){return x(this,e,t,r,!0)}off(e,t,r,n=!1){const a=this._prefix?`${this._prefix}${e}`:e;if(!this.has(e))return this;const i=this._listeners[a];if(!t||i.length<=1)return q(this,a),this;const s=i.findIndex((e=>e.handler===t&&e.context===(r||this)&&e.once===n));return s>-1&&i.splice(s,1),this}clear(e){const t=this._prefix?`${this._prefix}${e}`:e;return this.has(e)?q(this,t):(this._listeners=new F,this._listenerCount=0),this}emit(e,...t){const r=this._prefix?`${this._prefix}${e}`:e;if(this.has(e)||this.has($.EVENT_CONFIG.ALL_EVENTS_KEY)){let n=this._listeners[r];if(this.has($.EVENT_CONFIG.ALL_EVENTS_KEY)){n=[...n=n||[],...this._listeners[$.EVENT_CONFIG.ALL_EVENTS_KEY]]}for(let e=n.length;e>=0;e-=1){const a=n[e];if(a){const{handler:e,once:n,context:i}=a;n&&this.off(r,e,i,n),e.call(i,...t)}}return k(this,e,...t),!0}return k(this,e,...t),!1}all(e,t){return x(this,$.EVENT_CONFIG.ALL_EVENTS_KEY,e,t)}none(e,t){return this.off($.EVENT_CONFIG.ALL_EVENTS_KEY,e,t)}}$.EVENT_CONFIG={ALL_EVENTS_KEY:"~ALL_EVENTS~"};var B=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a},z=B;var Y,H=function(e,t){return z(t,(function(t){return[t,e[t]]}))},Q=f["__core-js_shared__"],X=(Y=/[^.]+$/.exec(Q&&Q.keys&&Q.keys.IE_PROTO||""))?"Symbol(src)_1."+Y:"";var J=function(e){return!!X&&X in e},Z=Function.prototype.toString;var W=function(e){if(null!=e){try{return Z.call(e)}catch(e){}try{return e+""}catch(e){}}return""},K=D,ee=J,te=A,re=W,ne=/^\[object .+?Constructor\]$/,ae=Function.prototype,ie=Object.prototype,se=ae.toString,oe=ie.hasOwnProperty,ce=RegExp("^"+se.call(oe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ue=function(e,t){return null==e?void 0:e[t]},le=function(e){return!(!te(e)||ee(e))&&(K(e)?ce:ne).test(re(e))},de=ue;var he=function(e,t){var r=de(e,t);return le(r)?r:void 0},fe=he(f,"DataView"),me=he(f,"Map"),Ee=fe,pe=me,ve=he(f,"Promise"),_e=he(f,"Set"),ge=he(f,"WeakMap"),Oe=T,ye=W,Se="[object Map]",be="[object Promise]",Ie="[object Set]",Te="[object WeakMap]",Ae="[object DataView]",Ne=ye(Ee),Re=ye(pe),De=ye(ve),we=ye(_e),Ce=ye(ge),Le=Oe;(Ee&&Le(new Ee(new ArrayBuffer(1)))!=Ae||pe&&Le(new pe)!=Se||ve&&Le(ve.resolve())!=be||_e&&Le(new _e)!=Ie||ge&&Le(new ge)!=Te)&&(Le=function(e){var t=Oe(e),r="[object Object]"==t?e.constructor:void 0,n=r?ye(r):"";if(n)switch(n){case Ne:return Ae;case Re:return Se;case De:return be;case we:return Ie;case Ce:return Te}return t});var Me=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r};var je=H,Pe=Le,Ue=Me,Ve=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r};var Fe=function(e){return function(t){var r=Pe(t);return"[object Map]"==r?Ue(t):"[object Set]"==r?Ve(t):je(t,e(t))}};var Ge=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},xe=T,qe=U;var ke=function(e){return qe(e)&&"[object Arguments]"==xe(e)},$e=U,Be=Object.prototype,ze=Be.hasOwnProperty,Ye=Be.propertyIsEnumerable,He=ke(function(){return arguments}())?ke:function(e){return $e(e)&&ze.call(e,"callee")&&!Ye.call(e,"callee")},Qe=He,Xe=Array.isArray,Je={exports:{}};var Ze=function(){return!1};!function(e,t){var r=f,n=Ze,a=t&&!t.nodeType&&t,i=a&&e&&!e.nodeType&&e,s=i&&i.exports===a?r.Buffer:void 0,o=(s?s.isBuffer:void 0)||n;e.exports=o}(Je,Je.exports);var We=Je.exports,Ke=T,et=w,tt=U,rt={};rt["[object Float32Array]"]=rt["[object Float64Array]"]=rt["[object Int8Array]"]=rt["[object Int16Array]"]=rt["[object Int32Array]"]=rt["[object Uint8Array]"]=rt["[object Uint8ClampedArray]"]=rt["[object Uint16Array]"]=rt["[object Uint32Array]"]=!0,rt["[object Arguments]"]=rt["[object Array]"]=rt["[object ArrayBuffer]"]=rt["[object Boolean]"]=rt["[object DataView]"]=rt["[object Date]"]=rt["[object Error]"]=rt["[object Function]"]=rt["[object Map]"]=rt["[object Number]"]=rt["[object Object]"]=rt["[object RegExp]"]=rt["[object Set]"]=rt["[object String]"]=rt["[object WeakMap]"]=!1;var nt=function(e){return tt(e)&&et(e.length)&&!!rt[Ke(e)]};var at=function(e){return function(t){return e(t)}},it={exports:{}};!function(e,t){var r=l,n=t&&!t.nodeType&&t,a=n&&e&&!e.nodeType&&e,i=a&&a.exports===n&&r.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=s}(it,it.exports);var st=it.exports,ot=nt,ct=at,ut=st&&st.isTypedArray,lt=ut?ct(ut):ot,dt=Ge,ht=Qe,ft=Xe,mt=We,Et=P,pt=lt,vt=Object.prototype.hasOwnProperty;var _t=function(e,t){var r=ft(e),n=!r&&ht(e),a=!r&&!n&&mt(e),i=!r&&!n&&!a&&pt(e),s=r||n||a||i,o=s?dt(e.length,String):[],c=o.length;for(var u in e)!t&&!vt.call(e,u)||s&&("length"==u||a&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Et(u,c))||o.push(u);return o},gt=Object.prototype;var Ot=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||gt)};var yt=function(e,t){return function(r){return e(t(r))}},St=yt(Object.keys,Object),bt=Ot,It=St,Tt=Object.prototype.hasOwnProperty;var At=function(e){if(!bt(e))return It(e);var t=[];for(var r in Object(e))Tt.call(e,r)&&"constructor"!=r&&t.push(r);return t},Nt=_t,Rt=At,Dt=M;var wt=function(e){return Dt(e)?Nt(e):Rt(e)},Ct=Fe(wt),Lt=c(Ct),Mt=B;var jt=function(e,t){return Mt(t,(function(t){return e[t]}))},Pt=jt,Ut=wt;var Vt=c((function(e){return null==e?[]:Pt(e,Ut(e))}));const Ft=(e,t,r,n={})=>{const a=["namespace","module","method","message"][t],i=r[e[a]-1];return i&&(n[a]=i.text,i.children&&i.children.length)?Ft(e,t+1,i.children,n):n};class Gt{get level(){return Object.keys(Gt.TYPES)[this.type-1].toLowerCase()}get plainData(){return{createdAt:new Date(this.createdAt).toJSON(),level:this.level,namespace:this.namespace,module:this.module,method:this.method,message:this.message,internalMessage:this.internalMessage}}constructor(e,t,r,n,a,i=void 0){this.type=e,this.namespace=t,this.module=r,this.method=n,this.message=a,this.internalMessage=i,this.createdAt=Date.now()}includes(e){return!!this.internalMessage&&this.internalMessage.includes(e)}toJSON(e=!1){const{plainData:t}=this;return JSON.stringify(e?s(t,Gt.SHORTNAME_MAPPING):t)}prettify(e,t,r={abbreviate:!1,prefix:void 0,delimiter:" | "}){if(!0===Vt(Gt.FORMATS).includes(e)){const{plainData:n}=this,a={...n,...Ft(n,0,t)};if(e===Gt.FORMATS.JSON)return JSON.stringify(r.abbreviate?s(a,Gt.SHORTNAME_MAPPING):a);let i=[];return i=i.concat(Lt(a).map((([e,t])=>`${e.toUpperCase()}:${t}`))),r.prefix&&i.push(r.prefix),i.reverse().join(r.delimiter)}return""}}Gt.TYPES=Object.defineProperties({},{INFO:{value:1,enumerable:!0},WARNING:{value:2,enumerable:!0},ERROR:{value:3,enumerable:!0},FATAL:{value:4,enumerable:!0}}),Gt.FORMATS=Object.defineProperties({},{JSON:{value:1,enumerable:!0},LOG:{value:2,enumerable:!0}}),Gt.fromJSON=e=>{const t=JSON.parse(e);if(t.level&&void 0===t.type){const[,e]=Lt(Gt.TYPES).find((([e])=>e.toLowerCase()===t.level));t.type=e}const{type:r,namespace:n,module:a,method:i,message:s,internalMessage:o}=t;return new Gt(r,n,a,i,s,o)},Gt.SHORTNAME_MAPPING={level:"lv",type:"tp",namespace:"ns",module:"md",method:"mt",message:"ms",internalMessage:"im",createdAt:"ca"};var xt=Gt;class qt{get size(){return this.items.length}constructor(e){this.items=[];for(let t=0,r=e.length;t<r;t+=1)this.enqueue(e[t])}enqueue(e){this.items.push(e)}dequeue(){return this.items.shift()}flush(){this.items=[]}}const kt=(e,t)=>{try{const{options:n}=e;e.pending=!0;const a=Array.from(t),i=a.slice(1,a.length),s=a[0];let o,c=((e,t)=>{const{options:r,facades:n}=e;if(r.multiTenancy){const e="number"==typeof t[0]?t[0]:r.defaultTenant;return n.get(e)}return n.get(0)})(e,i);c||(c=((e,t)=>{const{facadeFactory:r,options:n}=e,a=r(e);if(n.multiTenancy){const r="number"==typeof t[0]?t[0]:n.defaultTenant;e.facades.set(r,a)}else e.facades.set(0,a);return a})(e,i)),o=!0===n.multiTenancy&&"number"==typeof i[0]?i.slice(1,i.length):i;const u=c[s](...o);!0===(r=u,Boolean(r&&"function"==typeof r.then))?u.then((t=>e.emit("executed",t))).catch((t=>e.emit("error",t))):e.emit("executed",s,u)}catch(t){e.emit("error",t)}var r};class $t extends ${constructor(e=void 0,t={},r=[]){super(),this.pending=!1,this.failed=!1,this.queue=new qt(r),this.facades=new Map,this.facadeFactory=e,this.options={mode:1,multiTenancy:!1,continueOnError:!0,logging:!1,defaultTenant:1,onError:void 0,onExecuted:void 0,...t},this.on("executed",(e=>((e,t)=>{const{options:r}=e;r.onExecuted&&"function"==typeof r.onExecuted&&r.onExecuted(t),e.pending=!1,e.failed=!1,r.mode===$t.MODE.AUTO&&e.dequeue()})(this,e))),this.on("error",(e=>((e,t)=>{const{options:r}=e;r.logging&&console.error(t),r.onError&&"function"==typeof r.onError&&r.onError(t),e.pending=!1,e.failed=!0,!0===r.continueOnError&&r.mode===$t.MODE.AUTO&&e.dequeue()})(this,e))),this.queue.size>0&&this.options.mode===$t.MODE.AUTO&&this.dequeue()}flush(){this.queue.flush()}addFacadeFactory(e){this.facadeFactory=e,this.queue.size>0&&this.options.mode===$t.MODE.AUTO&&this.dequeue()}removeFacadeFactory(){this.facadeFactory=void 0,this.facades.clear()}dequeue(){if(!0===this.pending)setTimeout((()=>this.dequeue()),10);else{if(this.queue.size>0&&(!1===this.failed||!0===this.options.continueOnError)&&this.facadeFactory&&"function"==typeof this.facadeFactory){const e=this.queue.dequeue();kt(this,e)}}}enqueue(...e){1===e.length&&"string"!=typeof e[0]?this.queue.enqueue(e[0]):this.queue.enqueue(e),this.options.mode===$t.MODE.AUTO&&this.dequeue()}push(...e){this.enqueue(...e)}}$t.MODE=Object.defineProperties({},{AUTO:{value:1,enumerable:!0},MANUAL:{value:2,enumerable:!0}});var Bt=c(Ct);var zt=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function Yt(e,t,r,n,a){return new xt(e,t,r,n,a)}const Ht=(e,t)=>{const r=Bt(e),n=[];for(let e=0,a=t.length;e<a;e+=1){const a=t[e],i=r.find((([e])=>e===a.name||e===a.abbreviation));let s;i&&(s=i[1]),n.push({...a,value:s})}return n};class Qt extends ${constructor(e){super(),this.moduleId=2,this.commands=e,this.parameters=void 0}parse(e,...t){const n=this.commands.find((t=>t.name===e||t.abbreviation===e));return n?(this.command=n,this.parameters=((e,t)=>{let n=[];const{parameters:a}=e;for(let o=0,c=a.length;o<c;o+=1){let c=a[o],u=t[o];if(r(u)&&e.options&&!0===e.options.allowJSON&&(u=JSON.parse(u)),"function"===zt(c)){const e=a[o](t);c=e&&1===e.length?e[0]:e}c&&(n="object"===zt(u)?n.concat(Ht(u,c)):n.concat((i=u,s=c,[{...s,value:i}])))}var i,s;return n})(n,t),this.emit(Qt.EVENTS.PARSING_SUCCEEDED,{command:n,parameters:this.parameters})):this.emit(Qt.EVENTS.PARSING_FAILED,Yt(xt.TYPES.ERROR,1,this.moduleId,1,1)),this}reset(){return this.command=void 0,this.parameters=void 0,this.emit(Qt.EVENTS.PARSING_RESET,Yt(xt.TYPES.INFO,1,this.moduleId,2,1)),this}}Qt.EVENTS={PARSING_FAILED:"PARSING_FAILED",PARSING_SUCCEEDED:"PARSING_SUCCEEDED",PARSING_RESET:"PARSING_RESET"};var Xt=Qt;const Jt={VALIDATION_ASSERTED:"VALIDATION_ASSERTED",VALIDATION_ABORTED:"VALIDATION_ABORTED",VALIDATION_FAILED:"VALIDATION_FAILED",VALIDATION_SUCCEEDED:"VALIDATION_SUCCEEDED",VALIDATION_RESET:"VALIDATION_RESET",VALIDATION_VALUE_MODIFIED:"VALIDATION_VALUE_MODIFIED"},Zt=e=>["requiredIf"].includes(e),Wt=(e,t)=>{const{rules:r,value:n}=e,a=[];for(let i=0,s=r.length;i<s;i+=1){const{name:s,assert:o}=r[i];if(Zt(s)){const r=t.find((t=>t.name===e.sibling));a.push({name:s,assertion:o(n,r.value)})}else a.push({name:s,assertion:o(n)})}return a},Kt=(e,t,r)=>{let n=!1;e.parameters[t].assertions=[];for(let a=0,i=r.length;a<i;a+=1){const{assertion:i,name:s}=r[a];if(e.parameters[t].assertions.push(i),n=i instanceof xt&&i.type===xt.TYPES.FATAL,!0===n)return{abort:n,assertion:i};if("array"===zt(i)){const[r,n,a]=i;e.parameters[t].value=r,e.emit(Jt.VALIDATION_VALUE_MODIFIED,{rule:s,modified:r,origin:n},a)}e.emit(Jt.VALIDATION_ASSERTED,s,Yt(xt.TYPES.INFO,1,e.moduleId,2,3))}return{abort:n}};class er extends Xt{constructor(e){super(e),this.moduleId=3,this.valid=!1,this.lastAssertion=void 0}validate(){return this.command&&this.parameters&&this.parameters.length>0?(this.valid=(e=>{for(let t=0,r=e.parameters.length;t<r;t+=1){const r=Wt(e.parameters[t],e.parameters),{abort:n,assertion:a}=Kt(e,t,r);if(e.lastAssertion=a,n)return e.emit(Jt.VALIDATION_ABORTED,a),!1}return!0})(this),!0===this.valid?this.emit(er.EVENTS.VALIDATION_SUCCEEDED,{command:this.command,parameters:this.parameters}):this.emit(er.EVENTS.VALIDATION_FAILED,Yt(xt.TYPES.FATAL,1,this.moduleId,2,2))):this.emit(er.EVENTS.VALIDATION_FAILED,Yt(xt.TYPES.ERROR,1,this.moduleId,2,1)),this}reset(){return this.valid=!1,super.reset(),this}}er.EVENTS={...Xt.EVENTS,...Jt};var tr=er;class rr extends tr{constructor(e){super(e),this.moduleId=5,this.data=void 0}serialize(e=!1){return this.command&&this.parameters&&this.parameters.length>0&&(this.data=((e,t)=>{const r={};for(let n=0,a=e.length;n<a;n+=1)r[t?e[n].abbreviation:e[n].name]=e[n].value;return r})(this.parameters,e),this.emit(rr.EVENTS.SERIALIZATION_SUCCEEDED,{command:this.command.name,parameters:this.data})),this}result(){return{command:this.command.name,parameters:this.data}}reset(){return this.data=void 0,super.reset()}}rr.EVENTS={...tr.EVENTS,SERIALIZATION_SUCCEEDED:"SERIALIZATION_SUCCEEDED"};var nr=rr,ar=he(Object,"create"),ir=ar;var sr=function(){this.__data__=ir?ir(null):{},this.size=0};var or=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cr=ar,ur=Object.prototype.hasOwnProperty;var lr=function(e){var t=this.__data__;if(cr){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return ur.call(t,e)?t[e]:void 0},dr=ar,hr=Object.prototype.hasOwnProperty;var fr=function(e){var t=this.__data__;return dr?void 0!==t[e]:hr.call(t,e)},mr=ar;var Er=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=mr&&void 0===t?"__lodash_hash_undefined__":t,this},pr=sr,vr=or,_r=lr,gr=fr,Or=Er;function yr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}yr.prototype.clear=pr,yr.prototype.delete=vr,yr.prototype.get=_r,yr.prototype.has=gr,yr.prototype.set=Or;var Sr=yr;var br=function(){this.__data__=[],this.size=0},Ir=u;var Tr=function(e,t){for(var r=e.length;r--;)if(Ir(e[r][0],t))return r;return-1},Ar=Tr,Nr=Array.prototype.splice;var Rr=function(e){var t=this.__data__,r=Ar(t,e);return!(r<0)&&(r==t.length-1?t.pop():Nr.call(t,r,1),--this.size,!0)},Dr=Tr;var wr=function(e){var t=this.__data__,r=Dr(t,e);return r<0?void 0:t[r][1]},Cr=Tr;var Lr=function(e){return Cr(this.__data__,e)>-1},Mr=Tr;var jr=function(e,t){var r=this.__data__,n=Mr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Pr=br,Ur=Rr,Vr=wr,Fr=Lr,Gr=jr;function xr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xr.prototype.clear=Pr,xr.prototype.delete=Ur,xr.prototype.get=Vr,xr.prototype.has=Fr,xr.prototype.set=Gr;var qr=Sr,kr=xr,$r=me;var Br=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},zr=Br;var Yr=function(e,t){var r=e.__data__;return zr(t)?r["string"==typeof t?"string":"hash"]:r.map},Hr=Yr;var Qr=function(e){var t=Hr(this,e).delete(e);return this.size-=t?1:0,t},Xr=Yr;var Jr=function(e){return Xr(this,e).get(e)},Zr=Yr;var Wr=function(e){return Zr(this,e).has(e)},Kr=Yr;var en=function(e,t){var r=Kr(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},tn=function(){this.size=0,this.__data__={hash:new qr,map:new($r||kr),string:new qr}},rn=Qr,nn=Jr,an=Wr,sn=en;function on(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}on.prototype.clear=tn,on.prototype.delete=rn,on.prototype.get=nn,on.prototype.has=an,on.prototype.set=sn;var cn=on,un=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ln=function(e){return this.__data__.has(e)};function dn(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new cn;++t<r;)this.add(e[t])}dn.prototype.add=dn.prototype.push=un,dn.prototype.has=ln;var hn=function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1};var fn=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1},mn=hn,En=function(e){return e!=e},pn=fn;var vn=function(e,t,r){return t==t?pn(e,t,r):mn(e,En,r)};var _n=function(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1};var gn=function(e,t){return e.has(t)},On=dn,yn=function(e,t){return!!(null==e?0:e.length)&&vn(e,t,0)>-1},Sn=_n,bn=B,In=at,Tn=gn,An=Math.min;var Nn=function(e,t,r){for(var n=r?Sn:yn,a=e[0].length,i=e.length,s=i,o=Array(i),c=1/0,u=[];s--;){var l=e[s];s&&t&&(l=bn(l,In(t))),c=An(l.length,c),o[s]=!r&&(t||a>=120&&l.length>=120)?new On(s&&l):void 0}l=e[0];var d=-1,h=o[0];e:for(;++d<a&&u.length<c;){var f=l[d],m=t?t(f):f;if(f=r||0!==f?f:0,!(h?Tn(h,m):n(u,m,r))){for(s=i;--s;){var E=o[s];if(!(E?Tn(E,m):n(e[s],m,r)))continue e}h&&h.push(m),u.push(f)}}return u};var Rn=function(e){return e};var Dn=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},wn=Dn,Cn=Math.max;var Ln=function(e,t,r){return t=Cn(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=Cn(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),wn(e,this,o)}};var Mn=function(e){return function(){return e}},jn=he,Pn=function(){try{var e=jn(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Un=Mn,Vn=Pn,Fn=Vn?function(e,t){return Vn(e,"toString",{configurable:!0,enumerable:!1,value:Un(t),writable:!0})}:Rn,Gn=Fn,xn=Date.now;var qn=function(e){var t=0,r=0;return function(){var n=xn(),a=16-(n-r);if(r=n,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},kn=qn(Gn),$n=Rn,Bn=Ln,zn=kn;var Yn=function(e,t){return zn(Bn(e,t,$n),e+"")},Hn=M,Qn=U;var Xn=function(e){return Qn(e)&&Hn(e)};var Jn=B,Zn=Nn,Wn=function(e){return Xn(e)?e:[]},Kn=c(Yn((function(e){var t=Jn(e,Wn);return t.length&&t[0]===e[0]?Zn(t):[]})));var ea=e=>"array"===zt(e)?!!e.length:null!=e&&!Number.isNaN(e)&&(!1===e||(e instanceof Date?!Number.isNaN(e.getTime()):"object"===zt(e)?!!Object.keys(e).length:!!String(e).length));var ta=e=>t=>!ea(t)||null!==t.toString().match(e);var ra=(e,t)=>r=>!ea(r)||(!/\s/.test(r)||r instanceof Date)&&e<=+r&&t>=+r;var na=e=>"array"===zt(e)?e.length:"object"===zt(e)?Object.keys(e).length:String(e).length;var aa=e=>t=>!ea(t)||na(t)<=e;var ia=e=>t=>!ea(t)||na(t)>=e;var sa=ta(/^\d*(\.\d+)?$/);var oa=e=>t=>!ea(t)||e.indexOf(t)>-1;var ca=e=>t=>!ea(t)||zt(t)===e;function ua(e,t){return(...r)=>e(...r)||t()}class la extends ${constructor(e,t,r={maxExecutionBeforeStop:3,fillParameters:!1}){super(),this.moduleId=4,this.history=new Map,this.stats={},this.data={},this.commandQueue=e,this.commandSerializer=new nr(t),this.options=r}process(e,...t){try{let r;const n=this.commandSerializer.commands.find((t=>t.name===e||t.abbreviation===e));if(n){const{abbreviation:a,name:i}=n;if(void 0===this.stats[a]&&(this.stats[a]=0),this.options.fillParameters&&!1===ea(t)&&this.data[a])return r={command:i,parameters:this.data[a]},this.emit(la.EVENTS.PROCESSING_SUCCEEDED,r),r;const{valid:s,stop:o}=((e,t,r,n)=>{let a=!0,i=!1;if(e.dependencies&&e.dependencies.length>0){const s=Array.from(t.keys());a=Kn(s,e.dependencies).length===e.dependencies.length,i=r[e.abbreviation]>n}return{stop:i,valid:a}})(n,this.history,this.stats,this.options.maxExecutionBeforeStop);if(!0===s&&!1===o)if(this.commandSerializer.reset().parse(e,...t).validate(),this.commandSerializer.valid){r=this.commandSerializer.serialize().result();const e="function"==typeof n.id?n.id(r.parameters):n.id;this.history.set(e,{parameters:t,createdAt:Date.now()}),this.stats[a]=0,this.data[a]=r.parameters,this.emit(la.EVENTS.PROCESSING_SUCCEEDED,r)}else this.stats[a]+=1,this.emit(la.EVENTS.PROCESSING_FAILED,this.commandSerializer.lastAssertion);else!1===s&&!1===o?(this.stats[a]+=this.stats[a]+1,this.commandQueue.enqueue(e,...t),this.emit(la.EVENTS.PROCESSING_REQUEUED,new xt(xt.TYPES.WARNING,1,this.moduleId,1,1))):this.emit(la.EVENTS.PROCESSING_FAILED,new xt(xt.TYPES.FATAL,1,this.moduleId,1,2))}return r}catch(e){const t=new xt(xt.TYPES.FATAL,1,this.moduleId,1,3,e.message);return void this.emit(la.EVENTS.PROCESSING_FAILED,t)}}getCommandParameters(e){const t=this.commandSerializer.commands.find((t=>t.name===e||t.abbreviation===e));if(t)return this.data[t.abbreviation]}reset(){this.commandSerializer.reset(),this.stats={},this.history=new Map,this.data={}}}la.EVENTS={PROCESSING_SUCCEEDED:"PROCESSING_SUCCEEDED",PROCESSING_FAILED:"PROCESSING_FAILED",PROCESSING_REQUEUED:"PROCESSING_REQUEUED"};var da=la;var ha=e=>({name:"appSite",abbreviation:"as",sibling:"hybrid",rules:e});var fa=e=>({name:"code",abbreviation:"cp",rules:e});var ma=e=>({name:"comment",abbreviation:"co",rules:e});var Ea=e=>({name:"consentString",abbreviation:"ct",rules:e});var pa=e=>({name:"country",abbreviation:"cn",rules:e});var va=e=>({name:"debug",abbreviation:"dg",rules:e});var _a=e=>({name:"distributionChannel",abbreviation:"dc",rules:e});var ga=e=>({name:"domainServiceName",abbreviation:"dn",rules:e});var Oa=e=>({name:"event",abbreviation:"ev",rules:e});var ya=e=>({name:"hybrid",abbreviation:"hy",rules:e});var Sa=e=>({name:"hybridToken",abbreviation:"ht",rules:e});var ba=e=>({name:"identity20",abbreviation:"i2",rules:e});var Ia=e=>({name:"mediaTypes",abbreviation:"mt",rules:e});var Ta=e=>({name:"methods",abbreviation:"mh",rules:e});var Aa=e=>({name:"mode",abbreviation:"mo",rules:e});var Na=e=>({name:"multiIdentifier",abbreviation:"mi",rules:e});var Ra=e=>({name:"panelIdentifier",abbreviation:"pid",rules:e,sibling:"panelVendorId"});var Da=e=>({name:"panelVendorId",abbreviation:"pvd",rules:e,sibling:"panelIdentifier"});var wa=e=>({name:"pixelType",abbreviation:"pt",rules:e});var Ca=e=>({name:"site",abbreviation:"st",rules:e});var La=e=>({name:"tenant",abbreviation:"ta",rules:e});var Ma=e=>({name:"thirdPartyModule",abbreviation:"3p",rules:e});var ja=(e,t,r)=>n=>e(n)||[t,n,Yt(2,...r)];var Pa=(e,t)=>({name:e,assert:t});var Ua=ta(/^[a-zA-Z0-9_]*$/);var Va=[Pa("required",ja(ea,void 0,[1,1,5,1])),Pa("typeOf",ua(ca("string"),(()=>Yt(4,1,1,5,2)))),Pa("siteIdentifier",ua(Ua,(()=>Yt(4,1,1,5,3)))),Pa("min",ua(ia(3),(()=>Yt(4,1,1,5,4)))),Pa("max",ua(aa(15),(()=>Yt(4,1,1,5,5))))];function Fa(e,t){return r=>ea(r)||[e,r,Yt(2,...t)]}var Ga=(e,t,r)=>n=>"string"!==zt(n)||!ea(n)||[n.replace(e,t),n,Yt(2,...r)];var xa=(e,t)=>r=>{if(ea(r)&&!1===aa(e)(r)){let n;return n="number"===zt(r)?((e,t)=>{let r=e.toString();return r=r.slice(0,t),parseInt(r,10)})(r,e):"array"===zt(r)||"string"===zt(r)?r.slice(0,e):"object"===zt(r)?((e,t)=>{const r=Object.keys(e),n={};for(let a=0,i=t;a<i;a+=1)n[r[a]]=e[r[a]];return n})(r,e):r,[n,r,Yt(2,...t)]}return!0};const qa="Leercode_nichtzuordnungsfaehig",ka=["qds","dcf","nid"];var $a=[Pa("required",ja(ea,qa,[1,1,6,1])),Pa("typeOf",ja(ca("string"),qa,[1,1,6,2])),Pa("sanitize",Ga(/[^a-zA-Z0-9,_/\-?#]/g,".",[1,1,6,3])),Pa("truncate",xa(256,[1,1,6,4]))];var Ba=[Pa("defaultValue",Fa(void 0,[1,1,7,1])),Pa("typeOf",ja(ca("string"),void 0,[1,1,7,2])),Pa("ascii",Ga(/[^\x20-\x7E]/g,".",[1,1,7,3])),Pa("truncate",xa(256,[1,1,7,4]))];var za=e=>ta(new RegExp(`^([0-9a-fA-F]{2})([0-9a-fA-F]{${4*e}})$`,"g"));var Ya=(e=!0)=>{const t=[Pa("required",ua(ea,(()=>Yt(4,1,1,8,1)))),Pa("typeOf",ua(ca("string"),(()=>Yt(4,1,1,8,2)))),Pa("consentString",ua(za(2),(()=>Yt(4,1,1,8,3))))];return!1===e&&t.splice(0,1),t};var Ha=oa(["de","at"]);var Qa=[Pa("defaultValue",Fa("de",[1,1,9,1])),Pa("typeOf",ja(ca("string"),"de",[1,1,9,2])),Pa("enum",ja(Ha,"de",[1,1,9,3]))];var Xa=[Pa("defaultValue",Fa(!1,[1,1,10,1])),Pa("typeOf",ua(ca("boolean"),(()=>Yt(4,1,1,10,2))))];var Ja=oa(["web","hyb","ctv"]);var Za=[Pa("defaultValue",Fa("web",[1,1,1,11,1])),Pa("typeOf",ja(ca("string"),"web",[1,1,11,2])),Pa("enum",ja(Ja,"web",[1,1,11,3]))];var Wa=[Pa("required",ua(ea,(()=>Yt(4,1,1,12,1)))),Pa("typeof",ua(ca("string"),(()=>Yt(4,1,1,12,2)))),Pa("regex",ua(ta(/^(data-)([a-f0-9]{10})\.([a-zA-Z0-9][a-zA-Z0-9-_]{1,63})(?:\.([a-z]{2,63}))?\.([a-z]{2,63})$/g),(()=>Yt(4,1,1,12,3))))];var Ka=oa(["inst","init","open","clse","play","resm","stop","fowa","bakw","recd","paus","forg","bakg","dele","refr","kill","view","alve","fini","mute","aforg","abakg","aclse","sple","scvl","serr","spyr","smdr","sfpl","sfqt","ssqt","stqt","soqt","sofc","scfc","scqt","splr","spli","sprs","spre","smrs","smre","sors","sore","sack","sapl","sapa","snsp"]);var ei=[Pa("required",ua(ea,(()=>Yt(4,1,1,13,1)))),Pa("typeof",ua(ca("string"),(()=>Yt(4,1,1,13,2)))),Pa("eventEnum",ua(Ka,(()=>Yt(4,1,1,13,3))))];var ti=[Pa("defaultValue",Fa(!0,[1,1,14,1])),Pa("typeOf",ua(ca("boolean"),(()=>Yt(4,1,1,14,2))))];var ri=[Pa("required",ua(ea,(()=>Yt(4,1,1,24,1)))),Pa("typeOf",ua(ca("string"),(()=>Yt(4,1,1,24,2))))];var ni=[Pa("defaultValue",Fa(!1,[1,1,31,1])),Pa("typeOf",ua(ca("boolean"),(()=>Yt(4,1,1,31,2))))];var ai=oa(["debug","hybrid"]);var ii=[Pa("required",ua(ea,(()=>Yt(4,1,1,19,1)))),Pa("typeof",ua(ca("string"),(()=>Yt(4,1,1,19,2)))),Pa("enum",ua(ai,(()=>Yt(4,1,1,19,3))))];var si=[Pa("required",ua(ea,(()=>Yt(4,1,1,28,1)))),Pa("typeof",ua(ca("string"),(()=>Yt(4,1,1,28,2))))];const oi=(e,t)=>!e||ea(t);var ci=e=>(t,r)=>{if("function"!==zt(e))return oi(t,r);const n=e(t);return oi(n,r)};var ui=[Pa("requiredIf",ua(ci(),(()=>Yt(4,1,1,29,1)))),Pa("typeOf",ja(ca("string"),void 0,[1,1,29,2]))];var li=[Pa("requiredIf",ua(ci(),(()=>Yt(4,1,1,30,1)))),Pa("typeOf",ja(ca("number"),0,[2,1,30,2]))];var di=oa(["cp","sp","xp"]);var hi=[Pa("defaultValue",Fa("cp",[1,1,20,1])),Pa("typeOf",ja(ca("string"),"cp",[1,1,20,2])),Pa("enum",ja(di,"cp",[1,1,20,3]))];var fi=[Pa("required",ua(ea,(()=>Yt(4,1,1,26,1)))),Pa("typeOf",ua(ca("string"),(()=>Yt(4,1,1,26,2)))),Pa("siteIdentifier",ua(Ua,(()=>Yt(4,1,1,26,3)))),Pa("min",ua(ia(3),(()=>Yt(4,1,1,26,4)))),Pa("max",ua(aa(15),(()=>Yt(4,1,1,26,5))))];var mi=[Pa("typeOf",ua(ca(sa),(()=>Yt(4,1,1,22,1)))),Pa("between",ua(ra(1,4),(()=>Yt(4,1,1,22,1))))];var Ei=oa(ka);var pi=[Pa("required",ua(ea,(()=>Yt(4,1,1,23,1)))),Pa("typeof",ua(ca("string"),(()=>Yt(4,1,1,23,2)))),Pa("enum",ua(Ei,(()=>Yt(4,1,1,23,3))))];var vi=[Pa("defaultValue",Fa(1,[1,1,17,1])),Pa("typeOf",ja(ca("number"),1,[1,1,17,2])),Pa("max",ja(ra(1,7),1,[1,1,17,3]))];var _i=[Pa("defaultValue",Fa(1,[1,1,18,1])),Pa("typeOf",ja(ca("number"),1,[1,1,18,2])),Pa("max",ja(ra(1,5),1,[1,1,18,3]))];var gi={id:1,name:"configure",abbreviation:"cf",parameters:[[ha(Va),Ea(Ya(!1)),pa(Qa),va(Xa),_a(Za),ga(Wa),ya(ti),ba(ni),Ia(vi),Ta(_i),Ra(ui),Da(li),Ca(fi),La(mi)]],options:{allowJSON:!0}};var Oi={id:3,name:"event",abbreviation:"ev",dependencies:[1,2],parameters:[Oa(ei)],options:{allowJSON:!1}};var yi={id:4,name:"hybrid",abbreviation:"hy",parameters:[[pa(Qa),va(Xa),ga(Wa),Ca(fi),Sa(ri)]],options:{allowJSON:!0}};var Si=[gi,{id:2,name:"pageview",abbreviation:"pv",dependencies:[1],parameters:[[fa($a),ma(Ba),wa(hi),La(mi)]],options:{allowJSON:!0}},yi,Oi,{id:5,name:"setMode",abbreviation:"sm",parameters:[Aa(ii)],options:{allowJSON:!1}},{id:6,name:"setMultiIdentifier",abbreviation:"smi",parameters:[Na(si)],options:{allowJSON:!1}},{id:e=>ka.indexOf(e.thirdPartyModule)+7,name:"thirdPartyModules",abbreviation:"3p",dependencies:[1,2],parameters:[Ma(pi)],options:{allowJSON:!1}}],bi="object"==typeof global&&global&&global.Object===Object&&global,Ii="object"==typeof self&&self&&self.Object===Object&&self,Ti=bi||Ii||Function("return this")(),Ai=Ti.Symbol,Ni=Object.prototype,Ri=Ni.hasOwnProperty,Di=Ni.toString,wi=Ai?Ai.toStringTag:void 0;var Ci=Object.prototype.toString;var Li="[object Null]",Mi="[object Undefined]",ji=Ai?Ai.toStringTag:void 0;function Pi(e){return null==e?void 0===e?Mi:Li:ji&&ji in Object(e)?function(e){var t=Ri.call(e,wi),r=e[wi];try{e[wi]=void 0;var n=!0}catch(e){}var a=Di.call(e);return n&&(t?e[wi]=r:delete e[wi]),a}(e):function(e){return Ci.call(e)}(e)}function Ui(e){return null!=e&&"object"==typeof e}var Vi="[object Symbol]";function Fi(e){return"symbol"==typeof e||Ui(e)&&Pi(e)==Vi}function Gi(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var xi=Array.isArray,qi=1/0,ki=Ai?Ai.prototype:void 0,$i=ki?ki.toString:void 0;function Bi(e){if("string"==typeof e)return e;if(xi(e))return Gi(e,Bi)+"";if(Fi(e))return $i?$i.call(e):"";var t=e+"";return"0"==t&&1/e==-qi?"-0":t}var zi=/\s/;var Yi=/^\s+/;function Hi(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&zi.test(e.charAt(t)););return t}(e)+1).replace(Yi,""):e}function Qi(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Xi=NaN,Ji=/^[-+]0x[0-9a-f]+$/i,Zi=/^0b[01]+$/i,Wi=/^0o[0-7]+$/i,Ki=parseInt;var es=1/0,ts=17976931348623157e292;function rs(e){return e?(e=function(e){if("number"==typeof e)return e;if(Fi(e))return Xi;if(Qi(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Qi(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Hi(e);var r=Zi.test(e);return r||Wi.test(e)?Ki(e.slice(2),r?2:8):Ji.test(e)?Xi:+e}(e))===es||e===-es?(e<0?-1:1)*ts:e==e?e:0:0===e?e:0}function ns(e){var t=rs(e),r=t%1;return t==t?r?t-r:t:0}function as(e){return e}var is="[object AsyncFunction]",ss="[object Function]",os="[object GeneratorFunction]",cs="[object Proxy]";function us(e){if(!Qi(e))return!1;var t=Pi(e);return t==ss||t==os||t==is||t==cs}var ls=Ti["__core-js_shared__"],ds=function(){var e=/[^.]+$/.exec(ls&&ls.keys&&ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var hs=Function.prototype.toString;var fs=/^\[object .+?Constructor\]$/,ms=Function.prototype,Es=Object.prototype,ps=ms.toString,vs=Es.hasOwnProperty,_s=RegExp("^"+ps.call(vs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function gs(e){return!(!Qi(e)||(t=e,ds&&ds in t))&&(us(e)?_s:fs).test(function(e){if(null!=e){try{return hs.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function Os(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return gs(r)?r:void 0}var ys=Date.now;var Ss,bs,Is,Ts=function(){try{var e=Os(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),As=Ts,Ns=As?function(e,t){return As(e,"toString",{configurable:!0,enumerable:!1,value:(r=t,function(){return r}),writable:!0});var r}:as,Rs=(Ss=Ns,bs=0,Is=0,function(){var e=ys(),t=16-(e-Is);if(Is=e,t>0){if(++bs>=800)return arguments[0]}else bs=0;return Ss.apply(void 0,arguments)}),Ds=Rs;function ws(e){return e!=e}function Cs(e,t){return!!(null==e?0:e.length)&&function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}(e,t,r):function(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}(e,ws,r)}(e,t,0)>-1}var Ls=Math.max;function Ms(e,t){return Ds(function(e,t,r){return t=Ls(void 0===t?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=Ls(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}(e,this,o)}}(e,t,as),e+"")}var js=9007199254740991;function Ps(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=js}(e.length)&&!us(e)}function Us(e){return Ui(e)&&"[object Arguments]"==Pi(e)}var Vs=Object.prototype,Fs=Vs.hasOwnProperty,Gs=Vs.propertyIsEnumerable,xs=Us(function(){return arguments}())?Us:function(e){return Ui(e)&&Fs.call(e,"callee")&&!Gs.call(e,"callee")},qs=xs;function ks(e){return function(t){return e(t)}}var $s=Os(Object,"create");var Bs=Object.prototype.hasOwnProperty;var zs=Object.prototype.hasOwnProperty;function Ys(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Hs(e,t){for(var r,n,a=e.length;a--;)if((r=e[a][0])===(n=t)||r!=r&&n!=n)return a;return-1}Ys.prototype.clear=function(){this.__data__=$s?$s(null):{},this.size=0},Ys.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ys.prototype.get=function(e){var t=this.__data__;if($s){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Bs.call(t,e)?t[e]:void 0},Ys.prototype.has=function(e){var t=this.__data__;return $s?void 0!==t[e]:zs.call(t,e)},Ys.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=$s&&void 0===t?"__lodash_hash_undefined__":t,this};var Qs=Array.prototype.splice;function Xs(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xs.prototype.clear=function(){this.__data__=[],this.size=0},Xs.prototype.delete=function(e){var t=this.__data__,r=Hs(t,e);return!(r<0)&&(r==t.length-1?t.pop():Qs.call(t,r,1),--this.size,!0)},Xs.prototype.get=function(e){var t=this.__data__,r=Hs(t,e);return r<0?void 0:t[r][1]},Xs.prototype.has=function(e){return Hs(this.__data__,e)>-1},Xs.prototype.set=function(e,t){var r=this.__data__,n=Hs(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var Js=Os(Ti,"Map");function Zs(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function Ws(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ks(e){return null==e?"":Bi(e)}function eo(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}Ws.prototype.clear=function(){this.size=0,this.__data__={hash:new Ys,map:new(Js||Xs),string:new Ys}},Ws.prototype.delete=function(e){var t=Zs(this,e).delete(e);return this.size-=t?1:0,t},Ws.prototype.get=function(e){return Zs(this,e).get(e)},Ws.prototype.has=function(e){return Zs(this,e).has(e)},Ws.prototype.set=function(e,t){var r=Zs(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var to=Ai?Ai.isConcatSpreadable:void 0;function ro(e){return xi(e)||qs(e)||!!(to&&e&&e[to])}function no(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=ro),a||(a=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?no(o,t-1,r,n,a):eo(a,o):n||(a[a.length]=o)}return a}function ao(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:function(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}(e,t,r)}var io=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function so(e){return io.test(e)}var oo="\\ud800-\\udfff",co="["+oo+"]",uo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",lo="\\ud83c[\\udffb-\\udfff]",ho="[^"+oo+"]",fo="(?:\\ud83c[\\udde6-\\uddff]){2}",mo="[\\ud800-\\udbff][\\udc00-\\udfff]",Eo="(?:"+uo+"|"+lo+")"+"?",po="[\\ufe0e\\ufe0f]?",vo=po+Eo+("(?:\\u200d(?:"+[ho,fo,mo].join("|")+")"+po+Eo+")*"),_o="(?:"+[ho+uo+"?",uo,fo,mo,co].join("|")+")",go=RegExp(lo+"(?="+lo+")|"+_o+vo,"g");function Oo(e){return so(e)?function(e){return e.match(go)||[]}(e):function(e){return e.split("")}(e)}var yo=Os(Ti,"Set");function So(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Ws;++t<r;)this.add(e[t])}function bo(e,t){return e.has(t)}function Io(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function To(e){return Ui(e)&&Ps(e)}function Ao(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}So.prototype.add=So.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},So.prototype.has=function(e){return this.__data__.has(e)};var No=Math.min;function Ro(e){return To(e)?e:[]}var Do=Ms((function(e){var t=Gi(e,Ro);return t.length&&t[0]===e[0]?function(e,t,r){for(var n=r?Ao:Cs,a=e[0].length,i=e.length,s=i,o=Array(i),c=1/0,u=[];s--;){var l=e[s];s&&t&&(l=Gi(l,ks(t))),c=No(l.length,c),o[s]=!r&&(t||a>=120&&l.length>=120)?new So(s&&l):void 0}l=e[0];var d=-1,h=o[0];e:for(;++d<a&&u.length<c;){var f=l[d],m=t?t(f):f;if(f=r||0!==f?f:0,!(h?bo(h,m):n(u,m,r))){for(s=i;--s;){var E=o[s];if(!(E?bo(E,m):n(e[s],m,r)))continue e}h&&h.push(m),u.push(f)}}return u}(t):[]})),wo=Do,Co=9007199254740991,Lo=Math.floor;function Mo(e,t){var r="";if(!e||t<1||t>Co)return r;do{t%2&&(r+=e),(t=Lo(t/2))&&(e+=e)}while(t);return r}var jo,Po=(jo="length",function(e){return null==e?void 0:e[jo]}),Uo="\\ud800-\\udfff",Vo="["+Uo+"]",Fo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Go="\\ud83c[\\udffb-\\udfff]",xo="[^"+Uo+"]",qo="(?:\\ud83c[\\udde6-\\uddff]){2}",ko="[\\ud800-\\udbff][\\udc00-\\udfff]",$o="(?:"+Fo+"|"+Go+")"+"?",Bo="[\\ufe0e\\ufe0f]?",zo=Bo+$o+("(?:\\u200d(?:"+[xo,qo,ko].join("|")+")"+Bo+$o+")*"),Yo="(?:"+[xo+Fo+"?",Fo,qo,ko,Vo].join("|")+")",Ho=RegExp(Go+"(?="+Go+")|"+Yo+zo,"g");function Qo(e){return so(e)?function(e){for(var t=Ho.lastIndex=0;Ho.test(e);)++t;return t}(e):Po(e)}var Xo=Math.ceil;function Jo(e,t){var r=(t=void 0===t?" ":Bi(t)).length;if(r<2)return r?Mo(t,e):t;var n=Mo(t,Xo(e/Qo(t)));return so(t)?ao(Oo(n),0,e).join(""):n.slice(0,e)}function Zo(e,t,r){e=Ks(e);var n=(t=ns(t))?Qo(e):0;return t&&n<t?Jo(t-n,r)+e:e}var Wo=yo&&1/Io(new yo([,-0]))[1]==1/0?function(e){return new yo(e)}:function(){},Ko=Wo;var ec=Ms((function(e){return function(e,t,r){var n=-1,a=Cs,i=e.length,s=!0,o=[],c=o;if(r)s=!1,a=Ao;else if(i>=200){var u=t?null:Ko(e);if(u)return Io(u);s=!1,a=bo,c=new So}else c=t?[]:o;e:for(;++n<i;){var l=e[n],d=t?t(l):l;if(l=r||0!==l?l:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(l)}else a(c,d,r)||(c!==o&&c.push(d),o.push(l))}return o}(no(e,1,To,!0))})),tc=ec;const rc=e=>e.core?tc(Object.keys(e.core.purpose.consents).filter((t=>!0===e.core.purpose.consents[t])).map((e=>+e)),Object.keys(e.core.purpose.legitimateInterests).filter((t=>!0===e.core.purpose.legitimateInterests[t])).map((e=>+e))).concat(Object.keys(e.core.specialFeatureOptins).filter((t=>!0===e.core.specialFeatureOptins[t])).map((e=>+e+10))):tc(Object.keys(e.purpose.consents).filter((t=>!0===e.purpose.consents[t])).map((e=>+e)),Object.keys(e.purpose.legitimateInterests).filter((t=>!0===e.purpose.legitimateInterests[t])).map((e=>+e))).concat(Object.keys(e.specialFeatureOptins).filter((t=>!0===e.specialFeatureOptins[t])).map((e=>+e+10)));var nc=(e,t)=>{const r=((e,t)=>e.core?wo(tc(Object.keys(e.core.vendorConsents).filter((t=>!0===e.core.vendorConsents[t])).map((e=>+e)),Object.keys(e.core.vendorLegitimateInterests).filter((t=>!0===e.core.vendorLegitimateInterests[t])).map((e=>+e))),t):wo(tc(Object.keys(e.vendor.consents).filter((t=>!0===e.vendor.consents[t])).map((e=>+e)),Object.keys(e.vendor.legitimateInterests).filter((t=>!0===e.vendor.legitimateInterests[t])).map((e=>+e))),t))(e,t),n=[];for(let a=0,i=t.length;a<i;a+=1){let i=[];const s=t[a];r.includes(s)&&(i=rc(e)),n.push(i)}return n};const ac=e=>e.map((e=>2**(e-1))).reduce(((e,t)=>e+t),0);class ic{constructor(e,t,r){Object.defineProperties(this,{type:{value:e,writable:!1,enumerable:!0,configurable:!1},value:{value:t,writeable:!1,enumerable:!0,configurable:!1},vendors:{value:r,writeable:!1,enumerable:!0,configurable:!1}})}check(e,t){const r=this.vendors.indexOf(e),n=Array.isArray(t)?t:[t];if(r>-1){let e=ac(n);if(r<this.vendors.length-1){let t=e.toString(16);t=function(e,t,r){e=Ks(e);var n=(t=ns(t))?Qo(e):0;return t&&n<t?e+Jo(t-n,r):e}(t,4*(this.vendors.length-r)-(4-t.length),"0"),e=parseInt(t,16)}return(this.value&e)===e}return!1}toString(e=16){return 2===e?`${Zo(this.type.toString(2),8,"0")}${Zo(this.value.toString(2),16*this.vendors.length,"0")}`:`${Zo(this.type.toString(e),2,"0")}${Zo(this.value.toString(e),4*this.vendors.length,"0")}`}static create(e,t,r=ic.TYPES.TCF2X){let n="";for(let r=0,a=e.length;r<a;r+=1){n+=Zo(ac(t[r]).toString(16),4,"0")}return n=parseInt(n,16),new ic(r,n,e)}}ic.TYPES=Object.defineProperties({},{NONE:{value:0,writeable:!1,enumerable:!0,configurable:!1},TCF2X:{value:1,writeable:!1,enumerable:!0,configurable:!1},CUSTOM:{value:255,writeable:!1,enumerable:!0,configurable:!1}});var sc=ic;class oc extends ${constructor(e){super(),this.vendors=e,this.ioConsentString=void 0}convert(e){try{if(e){const t=nc(e,this.vendors);return this.ioConsentString=sc.create(this.vendors,t),this.emit(oc.EVENTS.TCF_CONVERT_SUCCESS,{ioConsentString:this.ioConsentString}),this.ioConsentString}throw new xt(xt.TYPES.ERROR,3,3,2,1)}catch(e){const t=new xt(xt.TYPES.ERROR,3,3,2,2,e instanceof xt?e:e.message);return void this.emit(oc.EVENTS.TCF_CONVERT_FAILED,t)}}}var cc=oc;oc.EVENTS={TCF_CONVERT_SUCCESS:"TCF_CONVERT_SUCCESS",TCF_CONVERT_FAILED:"TCF_CONVERT_FAILED"};const uc=e=>{const{category:t,validated:r}=e;if(!r){if(!t||!Object.values(lc.CATEGORIES).includes(t))throw new xt(4,1,3,1,1);e.validated=!0}};class lc extends ${constructor(){super(),this.moduleId=3,this.data=void 0}setItem(e,t,r){try{uc(r);const{category:n}=r;void 0===this.data&&(this.data={global:{},measurement:{},sensor:{},feature:{},plugins:{},thirdPartyPlugins:{},tcf:{},bundleLoaded:{},version:{}}),this.data[n][e]=t,this.emit(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,n,e),{key:e,value:t,category:n})}catch(e){throw new xt(4,1,this.moduleId,2,1,e instanceof xt?e:e.message)}}setItems(e,t,r){uc(r);for(let n=0,a=e.length;n<a;n+=1)this.setItem(e[n],t[n],r)}deleteItem(e,t){try{if(uc(t),this.data){const{category:r}=t;delete this.data[r][e],this.emit(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.DELETE,r,e),{key:e,category:r})}}catch(e){throw new xt(4,1,this.moduleId,4,1,e.message)}}deleteItems(e,t){uc(t);for(let r=0,n=e.length;r<n;r+=1)this.deleteItem(e[r],t)}getItem(e,t){try{uc(t);const{category:r}=t,n={key:e,category:r,value:void 0};return this.data&&this.data[r]&&void 0!==this.data[r][e]&&(n.value=this.data[r][e]),n}catch(e){throw new xt(4,1,this.moduleId,6,1,e.message)}}getItems(e,t){uc(t);const r=[];for(let n=0,a=e.length;n<a;n+=1)r.push(this.getItem(e[n],t));return r}static generateDataMutationEventName(e,t,r){return`data.mutation.${`${e}.${t}.${r}`.toLowerCase()}`}}lc.CATEGORIES={GLOBAL:"global",MEASUREMENT:"measurement",SENSOR:"sensor",FEATURE:"feature",PLUGINS:"plugins",THIRD_PARTY_PLUGINS:"thirdPartyPlugins",TCF:"tcf",BUNDLE_LOADED:"bundleLoaded",VERSION:"version"},lc.MUTATION_EVENTS={SET:"SET",DELETE:"DELETE"};const dc=(e,t)=>{if(t.tcf){const{value:r}=e.manager.dataLayer.getItem("consentString",{category:"tcf"});r instanceof sc&&t.queue.queue.items.forEach(((e,n)=>{"configure"===e[0]&&(e[1].consentString=r.toString(16),t.queue.queue.items[n]=e)}))}},hc=(e,t,r)=>{if(t.tcf){const{value:t}=e.manager.dataLayer.getItem("consentString",{category:"tcf"});t instanceof sc&&(r.consentString=t.toString(16))}return r},fc=(e,r,n)=>"object"===t(r)?Object.keys(r).reduce(((t,a)=>(n.parameterBlacklist&&n.parameterBlacklist[e]&&n.parameterBlacklist[e].includes(a)||(t[a]=r[a]),t)),{}):r;class mc extends ${constructor(e,t){super(),this.moduleId=2,this.manager=e,this.defaultModules=t.map((e=>e.name)),this.modules=new Map(t.map((e=>[e.name,{...e,queue:new $t(void 0,{mode:$t.MODE.MANUAL}),active:!1,tcf:!!e.tcf}]))),this.manager.dataLayer.on(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,lc.CATEGORIES.TCF,"consentString"),(()=>{this.handleConsentChanged()}))}addModule(e,t){if(this.modules.has(e)){const e=new xt(3,1,this.moduleId,3,1);this.emit(mc.EVENTS.ADD_MODULE,e)}else this.modules.set(e,{...t,queue:new $t(void 0,{mode:$t.MODE.MANUAL}),active:!1})}addFacade(e,t){const r=this.modules.get(e);r.queue.addFacadeFactory(t),this.modules.set(e,r)}removeFacade(e){const t=this.modules.get(e);t.queue.removeFacadeFactory(),this.modules.set(e,t)}activate(e){const t=this.modules.get(e);dc(this,t),t.active=!0,t.queue.options.mode=$t.MODE.AUTO,t.queue.dequeue(),this.modules.set(e,t)}deactivate(e){const t=this.modules.get(e);t.active=!1,t.queue.options.mode=$t.MODE.MANUAL,t.queue.flush(),this.modules.set(e,t)}enqueue(e,t={}){try{this.modules.forEach(((r,n)=>{if(-1===this.defaultModules.indexOf(n))return;let i=a(t);i=fc(e,t,r),"configure"===e&&(i=hc(this,r,i)),r.queue.enqueue(e,i)}))}catch(e){const t=new xt(3,1,this.moduleId,1,1,e);throw this.emit(mc.EVENTS.ENQUEUE_ERROR,t),t}}enqueueToSingleModule(e,t,r={}){try{const n=this.modules.get(e);if(n){let e=a(r);e=fc(t,r,n),"configure"===t&&(e=hc(this,n,e)),n.queue.enqueue(t,e)}}catch(e){const t=new xt(3,1,this.moduleId,4,1,e);throw this.emit(mc.EVENTS.ENQUEUE_ERROR,t),t}}dequeue(){try{this.modules.forEach(((e,t)=>{-1!==this.defaultModules.indexOf(t)&&e.queue.dequeue()}))}catch(e){const t=new xt(3,1,this.moduleId,2,1,e);throw this.emit(mc.EVENTS.ENQUEUE_ERROR,t),t}}handleConsentChanged(){try{this.modules.forEach((e=>{dc(this,e)}))}catch(e){const t=new xt(xt.TYPES.ERROR,3,this.moduleId,5,2,e.message);this.emit(mc.EVENTS.EXECUTION_ERROR,t)}}}mc.EVENTS={MODULE_NOT_LOADED:"MODULE_NOT_LOADED",QUEUE_CREATION_ERROR:"QUEUE_CREATION_ERROR",QUEUE_DOES_NOT_EXIST:"QUEUE_DOES_NOT_EXIST",ENQUEUE_ERROR:"ENQUEUE_ERROR",DEQUEUE_ERROR:"DEQUEUE_ERROR",ADD_MODULE:"ADD_MODULE",EXECUTION_ERROR:"EXECUTION_ERROR"};const Ec=1,pc=2,vc=3;function _c(e=8){let t="";const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n+=1)t+=r.charAt(Math.floor(62*Math.random()));return t}const gc={sensors:{iomb:{bit:1,cdn:{host:()=>"dsn",path:({ecmaVersion:e,variant:t,version:r})=>`/iomb/${r}/sensor/manager/${t}/${e}/bundle.js`},parameterBlacklist:{configure:["panelIdentifier","panelVendorId"]}},iomp:{bit:4,tcf:{consent:[1,8],vendor:730},cdn:{host:({country:e})=>"at"===e?"script-at.iocnt.net":"script.ioam.de",path:({ecmaVersion:e,variant:t,version:r})=>`/sensor/${r}/manager/${t}/${e}/bundle.js`},parameterBlacklist:{configure:[]}}},modules:{id2:{cdn:{host:({country:e})=>"at"===e?"id2.iocnt.net":"id2.ioam.de",path:()=>`/${_c(8)}.js`},tcf:{consent:[1,8],vendor:730}}},tcf:{vendors:[730,785],frequency:100,max:10,wait:5e3,events:["tcloaded","useractioncomplete"]},cdn:["dsn","script.ioam.de"],hybrid:{performSiteCheck:!1,apiKeys:e=>"at"===e?{ios:"IOMbOEWAHybridMessageHandler",android:"IOMbOEWAHybridBridge"}:{ios:"IOMbHybridMessageHandler",android:"IOMbHybridBridge"}},metaTags:{loading:"iomm_config_loading"}};var Oc=gc;const yc=1,Sc=2,bc=3,Ic=e=>Oc.sensors[e]?{name:e,...Oc.sensors[e]}:Oc.modules[e]?{name:e,...Oc.modules[e]}:null;var Tc=(e=yc)=>{const t=[];return e!==yc&&e!==Sc||Object.keys(Oc.sensors).forEach((e=>{t.push({name:e,...Oc.sensors[e]})})),e!==yc&&e!==bc||Object.keys(Oc.modules).forEach((e=>{t.push({name:e,...Oc.modules[e]})})),t};const Ac={iomb:"IOMb",iomp:"IOMp",id2:"IOMi"};class Nc extends ${constructor(e,t,r=Oc){if(super(),this.moduleId=4,void 0===e)throw new xt(4,1,this.moduleId,1,1);this.dataLayer=e,this.manager=t,this.settings=r}load(t,r,n=!1){return new Promise(((a,i)=>{try{const s={category:lc.CATEGORIES.SENSOR},o=this.dataLayer.getItem(r,s);if(o&&void 0===o.value){const o={url:t},{value:c="async"}=this.dataLayer.getItem("loading",{category:lc.CATEGORIES.GLOBAL});o[c]=c,r!==Nc.BUNDLE_VARIANTS.IOMP&&r!==Nc.BUNDLE_VARIANTS.QDS&&(o.crossOrigin="anonymous"),e(o).then((()=>{const e=Ac[r],t=window[e];t?(n||delete window[e],this.dataLayer.setItem(r,"function"==typeof t?t:()=>t,s),a()):i(new xt(3,1,this.moduleId,2,2))})).catch((e=>{i(new xt(3,1,this.moduleId,2,1,e.message))}))}else a()}catch(e){i(new xt(3,1,this.moduleId,2,3,e.message))}}))}generateSensorUrl(e){const t=Ic(e.sensorVariant);if(void 0===e.sensorVariant||void 0===t)throw new xt(3,1,this.moduleId,3,1);const r=this.dataLayer.getItem("country",{category:lc.CATEGORIES.GLOBAL}).value;let a="base";const i=this.settings.hybrid.apiKeys;e.sensorVariant!==Nc.BUNDLE_VARIANTS.IOMB&&e.sensorVariant!==Nc.BUNDLE_VARIANTS.IOMP||!function(e,t,r=Ec){const{value:a}=e.dataLayer.getItem("hybrid",{category:"global"}),i=n(t),s=Object.keys(t),o=e.commandProcessor.history.has(6)||e.commandProcessor.commandQueue.queue.items.findIndex((([e])=>"smi"===e||"setMultiIdentifier"===e))>-1;return r===pc?!0===a&&s.includes(i):r===vc?!0===a&&o:!0===a&&(s.includes(i)||o)}(this.manager,i(r),pc)||(a="hybrid");const{value:s}=this.dataLayer.getItem(t.name,{category:lc.CATEGORIES.VERSION});let o=(0,t.cdn.host)({country:r});"dsn"===o&&(o=this.dataLayer.getItem("domainServiceName",{category:lc.CATEGORIES.GLOBAL}).value);const c={ecmaVersion:window[window.IOMmGlobalObject].esm?"es6":"es5",variant:a,version:s||"latest"};return`//${o}${(0,t.cdn.path)(c)}`}generateModuleUrl(e){const t=Ic(e.moduleVariant);if(void 0===e.moduleVariant||void 0===t)throw new xt(3,1,this.moduleId,4,1);const{value:r}=this.dataLayer.getItem(t.name,{category:lc.CATEGORIES.VERSION});let n=(0,t.cdn.host)({country:this.dataLayer.getItem("country",{category:lc.CATEGORIES.GLOBAL}).value});"dsn"===n&&(n=this.dataLayer.getItem("domainServiceName",{category:lc.CATEGORIES.GLOBAL}).value);const a={ecmaVersion:window[window.IOMmGlobalObject].esm?"es6":"es5",version:r||"latest"};return`//${n}${(0,t.cdn.path)(a)}`}}Nc.BUNDLE_VARIANTS={IOMB:"iomb",IOMP:"iomp",ID2:"id2"},Nc.LOADING_METHODS={ASYNC:"async",DEFER:"defer"},Nc.LOADING_STATUS={LOADING:1,LOADED:2,LOADING_FAILED:3};const Rc=e=>{window.__tcfapi("removeEventListener",2,(()=>{}),e)},Dc=(e,t)=>{e&&e.listenerId>=0&&(t.stopPolling?Rc(e.listenerId):t.tcfApiListenerIds.push(e.listenerId))},wc=e=>(t,r)=>{try{if(Dc(t,e),e.stopPolling)return;let n;r&&e.settings.tcf.events.includes(t.eventStatus)&&!0===t.gdprApplies?(n=e.convert(t),e.emit(Lc.EVENTS.TCF_DATA_PROCESSED),window.__tcfapi("removeEventListener",2,(()=>{}),t.listenerId)):(n=sc.create(e.vendors,[[0],[0]],sc.TYPES.TCF2X),e.emit(Lc.EVENTS.TCF_DATA_CANNOT_BE_PROCESSED)),e.dataLayer.setItem("consentString",n,{category:lc.CATEGORIES.TCF})}catch(t){const r=new xt(xt.TYPES.ERROR,3,6,1,1,t.message);e.emit(Lc.EVENTS.TCF_DATA_PROCESSING_ERROR,r)}},Cc=e=>{e.stopPolling||(window.__tcfapi&&"function"==typeof window.__tcfapi?(window.__tcfapi("addEventListener",2,wc(e)),window.__tcfapi("addEventListener",2,(e=>(t,r)=>{Dc(t,e),e.stopPolling||r&&"cmpuishown"===t.eventStatus&&window.__tcfapi("addEventListener",2,wc(e))})(e))):(e.numberOfTries<e.settings.tcf.max+1?setTimeout((()=>{Cc(e)}),e.numberOfTries<e.settings.tcf.max?e.settings.tcf.frequency:e.settings.tcf.wait):e.emit(Lc.EVENTS.TCF_API_NOT_ACCESSIBLE),e.numberOfTries+=1))};class Lc extends cc{constructor(e,t,r=Oc){super(e),this.moduleId=6,this.vendors=e,this.dataLayer=t,this.numberOfTries=0,this.stopPolling=!1,this.tcfApiListenerIds=[],this.settings=r}process(){try{Cc(this)}catch(e){const t=new xt(xt.TYPES.ERROR,3,this.moduleId,5,1,e.message);throw this.emit(Lc.EVENTS.TCF_DATA_PROCESSING_ERROR,t),t}}stop(){try{this.tcfApiListenerIds.forEach((e=>{Rc(e)})),this.stopPolling=!0}catch(e){const t=new xt(xt.TYPES.ERROR,3,this.moduleId,6,1,e.message);throw this.emit(Lc.EVENTS.TCF_API_CANNOT_STOP,t),t}}}Lc.EVENTS={TCF_DATA_PROCESSED:"TCF_DATA_PROCESSED",TCF_DATA_CANNOT_BE_PROCESSED:"TCF_DATA_CANNOT_BE_PROCESSED",TCF_API_NOT_ACCESSIBLE:"TCF_API_NOT_ACCESSIBLE",TCF_DATA_PROCESSING_ERROR:"TC_DATA_PROCESSING_ERROR",TCF_API_CANNOT_STOP:"TCF_API_CANNOT_STOP"};var Mc=e=>{try{e.handledBfCache||(window.addEventListener("pageshow",(t=>{if(!0===t.persisted){const t=e.dataLayer.getItems(["code","comment","pixelType"],{category:"measurement"}).reduce(((e,{key:t,value:r})=>(e[t]=r,e)),{});setTimeout((()=>{e.command("pageview",t)}),0)}})),e.handledBfCache=!0)}catch(t){e.emit("EXECUTION_ERROR",t)}};var jc=(e,t)=>{try{const r=new sc(sc.TYPES.NONE,parseInt(e.substring(2),16),t.settings.tcf.vendors);if(r.toString(16)!==`00${e.substring(2)}`){throw new xt(xt.TYPES.ERROR,3,1,3,1)}return t.tcfProcessor.stop(),r}catch(e){return t.emit("MANUAL_CONSENT_ERROR",e),null}};var Pc=(e,t)=>{e!==Nc.LOADING_METHODS.ASYNC&&e!==Nc.LOADING_METHODS.DEFER||t.dataLayer.setItem("loading",e,{category:lc.CATEGORIES.GLOBAL})};var Uc=(e,t,r)=>{const n=t.toLowerCase().replace("v.","").replace("v","");if(n.match(/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/)){if(e.includes("iomm_config_version_sensor")){Tc(Sc).forEach((t=>{e.toLowerCase()===`iomm_config_version_sensor_${t.name}`&&r.dataLayer.setItem(t.name,n,{category:lc.CATEGORIES.VERSION})}))}if(e.includes("iomm_config_version_3p")||e.includes("iomm_config_version_ext")){Tc(bc).forEach((n=>{e.toLowerCase()!==`iomm_config_version_3p_${n.name}`&&e.toLowerCase()!==`iomm_config_version_ext_${n.name}`||r.dataLayer.setItem(n.name,t,{category:lc.CATEGORIES.VERSION})}))}}};var Vc=e=>{try{document.querySelectorAll("meta").forEach((t=>{const r=t.getAttribute("name"),n=t.getAttribute("content");r&&n&&(r===e.settings.metaTags.loading&&Pc(n,e),r.includes("iomm_config_version")&&Uc(r,n,e))}))}catch(t){const r=new xt(xt.TYPES.ERROR,3,1,4,1,t.message);e.emit("EXECUTION_ERROR",r)}};const Fc=(e,t)=>{try{const{value:r}=t.dataLayer.getItem("methods",{category:lc.CATEGORIES.GLOBAL});e.filter((e=>void 0===e.bit||(r&e.bit)===e.bit)).forEach((e=>{let r=!e.tcf;const n=t.dataLayer.getItem(e.name,{category:lc.CATEGORIES.SENSOR});if(e.tcf){const{value:a}=t.dataLayer.getItem("consentString",{category:lc.CATEGORIES.TCF});a&&a instanceof sc?(r=a.check(e.tcf.vendor,e.tcf.consent),r?(n.value||t.commandDispatcher.activate(e.name),t.dataLayer.on(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,lc.CATEGORIES.TCF,"consentString"),(()=>{Gc([e],t)}))):t.dataLayer.once(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,lc.CATEGORIES.TCF,"consentString"),(()=>{Fc([e],t)}))):t.dataLayer.once(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,lc.CATEGORIES.TCF,"consentString"),(()=>{Fc([e],t)}),e.name)}else t.commandDispatcher.activate(e.name);if(n.value)t.commandDispatcher.addFacade(e.name,n.value);else if(r){let r;t.dataLayer.once(lc.generateDataMutationEventName(lc.MUTATION_EVENTS.SET,lc.CATEGORIES.SENSOR,e.name),(()=>{Fc([e],t)})),r=Object.keys(t.settings.sensors).includes(e.name)?t.bundleLoader.generateSensorUrl({sensorVariant:e.name}):t.bundleLoader.generateModuleUrl({moduleVariant:e.name});const{value:n}=t.dataLayer.getItem(e.name,{category:lc.CATEGORIES.BUNDLE_LOADED});n||(t.dataLayer.setItem(e.name,Nc.LOADING_STATUS.LOADING,{category:lc.CATEGORIES.BUNDLE_LOADED}),t.bundleLoader.load(r,e.name,e.cdn.static).then((()=>{t.dataLayer.setItem(e.name,Nc.LOADING_STATUS.LOADED,{category:lc.CATEGORIES.BUNDLE_LOADED})})).catch((r=>{t.emit("EXECUTION_ERROR",r),t.dataLayer.setItem(e.name,Nc.LOADING_STATUS.LOADING_FAILED,{category:lc.CATEGORIES.BUNDLE_LOADED})})))}}))}catch(e){t.emit("EXECUTION_ERROR",e)}},Gc=(e,t)=>{try{e.filter((e=>{const{value:r}=t.dataLayer.getItem("methods",{category:lc.CATEGORIES.GLOBAL});return void 0===e.bit||(r&e.bit)===e.bit})).forEach((e=>{const{value:r}=t.dataLayer.getItem("consentString",{category:lc.CATEGORIES.TCF});if(r&&r instanceof sc){if(!1===r.check(e.tcf.vendor,e.tcf.consent))t.commandDispatcher.removeFacade(e.name),t.commandDispatcher.deactivate(e.name);else{const r=t.dataLayer.getItem(e.name,{category:lc.CATEGORIES.SENSOR});r&&r.value?(t.commandDispatcher.addFacade(e.name,r.value),t.commandDispatcher.activate(e.name)):Fc([e],t)}}}))}catch(e){t.emit("EXECUTION_ERROR",e)}};var xc=e=>{try{const t=e.dataLayer.getItem("country",{category:lc.CATEGORIES.GLOBAL}).value,r=e.dataLayer.getItem("debug",{category:lc.CATEGORIES.GLOBAL}).value,n=Ic(Nc.BUNDLE_VARIANTS.ID2);e.commandDispatcher.addModule(n.name,n),e.commandDispatcher.enqueueToSingleModule(n.name,"configure",{url:`https://${n.cdn.host({country:t})}/${_c(8)}`,debug:!!r&&!!r}),Fc([n],e)}catch(t){e.emit("EXECUTION_ERROR",t)}};class qc extends ${constructor(e,t=Oc){super(),this.moduleId=1,this.commandQueue=e,this.commandProcessor=new da(e,Si,{fillParameters:!0,maxExecutionBeforeStop:3}),this.dataLayer=new lc,this.commandDispatcher=new mc(this,Tc(Sc)),this.settings=t,this.bundleLoader=new Nc(this.dataLayer,this,this.settings),this.tcfProcessor=new Lc(this.settings.tcf.vendors,this.dataLayer,this.settings),this.skipExecution=!1,this.handledBfCache=!1,this.tcfProcessor.process(),Vc(this)}command(e,...t){try{this.commandProcessor.commandSerializer.reset();const r=this.commandProcessor.process(e,...t);if(r&&r.parameters){switch(e){case qc.COMMANDS.CONFIGURE:if(r.parameters.consentString){const e=jc(r.parameters.consentString,this);e&&e instanceof sc&&(r.parameters.consentString=e.toString(16),this.dataLayer.setItem("consentString",e,{category:lc.CATEGORIES.TCF})),null===e&&delete r.parameters.consentString}this.dataLayer.setItems(Object.keys(r.parameters),Object.values(r.parameters),{category:lc.CATEGORIES.GLOBAL}),r.parameters.identity20&&xc(this),Fc(Tc(Sc),this);break;case qc.COMMANDS.PAGEVIEW:this.dataLayer.deleteItem("event",{category:lc.CATEGORIES.MEASUREMENT}),this.dataLayer.setItems(Object.keys(r.parameters),Object.values(r.parameters),{category:lc.CATEGORIES.MEASUREMENT}),Mc(this);break;case qc.COMMANDS.THIRD_PARTY_MODULES:Ic(r.parameters.thirdPartyModule)&&((e,t)=>{try{const r=Ic(e.thirdPartyModule);t.commandDispatcher.addModule(r.name,r),t.commandDispatcher.enqueueToSingleModule(r.name,"configure",e),Fc([r],t)}catch(e){t.emit(qc.EVENTS.EXECUTION_ERROR,e)}})(r.parameters,this),this.skipExecution=!0;break;case qc.COMMANDS.EVENT:this.dataLayer.setItem("event",r.parameters.event,{category:lc.CATEGORIES.MEASUREMENT});break;case qc.COMMANDS.SET_MULTI_IDENTIFIER:this.dataLayer.setItem("multiIdentifier",r.parameters.multiIdentifier,{category:lc.CATEGORIES.GLOBAL}),this.commandDispatcher.enqueueToSingleModule(Nc.BUNDLE_VARIANTS.IOMP,qc.COMMANDS.SET_MULTI_IDENTIFIER,r.parameters.multiIdentifier),this.skipExecution=!0}return!1===this.skipExecution&&this.commandDispatcher.enqueue(e,r.parameters),void(this.skipExecution=!1)}throw new xt(xt.TYPES.FATAL,3,1,1,1,this.commandProcessor.commandSerializer.lastAssertion)}catch(e){throw e instanceof xt?e:new xt(xt.TYPES.FATAL,3,1,1,2,e.message)}}}function kc(e){const t=new qc(e);return{cf(...e){t.command(qc.COMMANDS.CONFIGURE,...e)},configure(...e){t.command(qc.COMMANDS.CONFIGURE,...e)},pv(...e){t.command(qc.COMMANDS.PAGEVIEW,...e)},pageview(...e){t.command(qc.COMMANDS.PAGEVIEW,...e)},sm(...e){t.command(qc.COMMANDS.SET_MODE,...e)},setMode(...e){t.command(qc.COMMANDS.SET_MODE,...e)},"3p"(...e){t.command(qc.COMMANDS.THIRD_PARTY_MODULES,...e)},thirdPartyModules(...e){t.command(qc.COMMANDS.THIRD_PARTY_MODULES,...e)},event(...e){t.command(qc.COMMANDS.EVENT,...e)},ev(...e){t.command(qc.COMMANDS.EVENT,...e)},hybrid(...e){t.command(qc.COMMANDS.HYBRID,...e)},hy(...e){t.command(qc.COMMANDS.HYBRID,...e)},smi(...e){t.command(qc.COMMANDS.SET_MULTI_IDENTIFIER,...e)},setMultiIdentifier(...e){t.command(qc.COMMANDS.SET_MULTI_IDENTIFIER,...e)}}}qc.COMMANDS={CONFIGURE:"configure",PAGEVIEW:"pageview",HYBRID:"hybrid",EVENT:"event",SET_MODE:"setMode",THIRD_PARTY_MODULES:"thirdPartyModules",SET_MULTI_IDENTIFIER:"setMultiIdentifier"},qc.EVENTS={COMMAND_DOES_NOT_EXIST:"COMMAND_DOES_NOT_EXIST",EXECUTION_ERROR:"EXECUTION_ERROR",MANUAL_CONSENT_ERROR:"MANUAL_CONSENT_ERROR"};const $c="IOMmGlobalObject"in window?window.IOMmGlobalObject:window.IOMmGlobalObject="IOMm",Bc=window[$c]||(window[$c]=(...e)=>{(window[$c].q=window[$c].q||[]).push(...e)});Bc.version="1.10.2",window.iom||(window.iom={},window.iom.smi=window.iom.setMultiIdentifier=e=>Bc("setMultiIdentifier",e)),Bc.q=new $t(kc,{multiTenancy:!0},Bc.q),Bc.create=kc}();
